---
// src/pages/brand/[slug].astro

import Layout from '../../components/common/Layout.astro';
import CategorySidebar from '../../components/brand/CategorySidebar.astro';
import ProductGrid from '../../components/product/ProductGrid.astro';
import AdvanceYourBody from '../../components/brand/AdvanceYourBody.astro';
import SolutionBasedProducts from '../../components/brand/SolutionBasedProducts.astro';
import BrandBanner from '../../components/brand/BrandBanner.astro';
import SportsBrandHero from '../../components/brand/SportsBrandHero.astro';

// ðŸ”¹ This is critical for dynamic routes
export async function getStaticPaths() {
  const brands = ['sports', 'vitamins', 'gummies', 'stevia'];
  return brands.map((slug) => ({ params: { slug } }));
}

const { slug } = Astro.params;

// Sample brand data
const brandData = {
  sports: {
    name: 'Sports',
    heroTitle: 'Fuel Performance.',
    heroSubtitle: 'Build Strength.',
    categories: [
      { name: 'Gold Mass Gainer' },
      { name: 'Whey Protein' },
      { name: 'ISO-Whey Protein' },
      { name: 'EAA + BCAA' },
      { name: 'L-Carnitine' },
      { name: 'Shots Pre-Workout' },
      { name: 'Creatine' },
      { name: 'Glutamine' },
      { name: 'Collagen' },
      { name: 'Glucosamine' },
    ],
    products: [
      { name: 'Gold Mass Gainer', short: 'High-calorie premium', folder: 'gold-mass-gainer' },
      { name: 'Whey Protein', short: 'Fast absorbing protein', folder: 'whey-protein' },
      { name: 'ISO-Whey Protein', short: '0 fat, low sugar', folder: 'iso-whey-protein' },
      { name: 'EAA + BCAA', short: 'Essential amino acids', folder: 'eaa-bcaa' },
      { name: 'L-Carnitine', short: 'Supports fat oxidation', folder: 'l-carnitine' },
      { name: 'Shots Pre-Workout', short: 'Boosts energy & focus', folder: 'shots-pre-workout' },
      { name: 'Creatine', short: 'Micronized monohydrate', folder: 'creatine' },
      { name: 'Glutamine', short: 'Supports recovery', folder: 'glutamine' },
      { name: 'Collagen', short: 'Hair, skin, nails', folder: 'collagen' },
      { name: 'Glucosamine', short: 'Supports joint health', folder: 'glucosamine' },
    ],
  },
  // add other brands if needed
};

const brand = brandData[slug];
if (!brand) throw new Error(`Brand "${slug}" not found`);

let selectedCategoryIndex = 0;
---

<Layout title={`${brand.name} | Biobolics`}>

  <!-- Hero Section -->
  {slug === 'sports' && <SportsBrandHero />}

  <!-- Brand Main Section -->
  <section class="brand-main mt-24"> <!-- add margin-top to push down -->
    <CategorySidebar
      categories={brand.categories}
      selectedIndex={selectedCategoryIndex}
      onSelect={(idx) => { selectedCategoryIndex = idx; }}
    />
    <ProductGrid products={brand.products} />
  </section>

  <!-- Additional Sections -->
  <AdvanceYourBody />
  <SolutionBasedProducts />
  <BrandBanner />

</Layout>

<style>
.brand-main {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 2rem;
  display: grid;
  grid-template-columns: 280px 1fr;
  gap: 2rem;
}

.brand-main.mt-24 {
  margin-top: 6rem; /* push down from hero */
}

@media (max-width: 768px) {
  .brand-main {
    grid-template-columns: 1fr;
  }
}
</style>
